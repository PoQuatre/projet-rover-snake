(()=>{"use strict";var t;!function(t){t[t.UP=0]="UP",t[t.DOWN=1]="DOWN",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT"}(t||(t={}));const e=20,i=50,a=50,l=(t,e,i)=>Math.min(Math.max(t,e),i),s={direction:t.UP,x:0,y:0,tailLength:0,tail:[],move(){let{x:e,y:i}=s;switch(this.direction){case t.UP:i--;break;case t.DOWN:i++;break;case t.LEFT:e--;break;case t.RIGHT:e++}return s.x=l(e,0,9),s.y=l(i,0,9),s.x!==e||s.y!==i},spawn(){this.x=Math.floor(10*Math.random()),this.y=Math.floor(10*Math.random());const e=10-this.x-1,i=10-this.y-1;Math.max(this.x,e)>Math.max(this.y,i)?this.direction=this.x>e?t.LEFT:t.RIGHT:this.direction=this.y>i?t.UP:t.DOWN},isTail(t,e){return this.tail.filter((i=>i.x===t&&i.y===e)).length>0},saveState(){this.state={direction:this.direction,x:this.x,y:this.y,tailLength:this.tailLength,tail:[...this.tail]}},rollbackState(){this.state&&(this.direction=this.state.direction,this.x=this.state.x,this.y=this.state.y,this.tailLength=this.state.tailLength,this.tail=[...this.state.tail])}},n={respawn(){let t=Math.floor(10*Math.random()),e=Math.floor(10*Math.random());for(;t===s.x&&e===s.y||s.isTail(t,e);)t=Math.floor(10*Math.random()),e=Math.floor(10*Math.random());this.x=t,this.y=e}},h=(t,l,h)=>{t.clearRect(0,0,l,h),(t=>{for(let l=0;l<10;l++)for(let s=0;s<10;s++)t.strokeRect(e+l*i,e+s*a,i,a)})(t),(t=>{t.fillStyle="#0f0",t.fillRect(e+s.x*i,e+s.y*a,i,a),t.fillStyle="#000"})(t),(t=>{t.fillStyle="#0f09";for(let l=0;l<s.tail.length;l++)t.fillRect(e+s.tail[l].x*i,e+s.tail[l].y*a,i,a);t.fillStyle="#000"})(t),(t=>{t.fillStyle="#f00","number"==typeof n.x&&"number"==typeof n.y&&t.fillRect(e+n.x*i,e+n.y*a,i,a),t.fillStyle="#000"})(t)},r=document.getElementById("score"),o=document.getElementById("game"),c=o.getContext("2d");if(null===c)throw new Error("An error occured while getting the canvas context");o.width=540,o.height=540,document.addEventListener("keydown",(e=>{switch(e.code){case"ArrowUp":case"KeyW":s.direction=t.UP;break;case"ArrowDown":case"KeyS":s.direction=t.DOWN;break;case"ArrowLeft":case"KeyA":s.direction=t.LEFT;break;case"ArrowRight":case"KeyD":s.direction=t.RIGHT}})),(()=>{let e=null,i=null;document.addEventListener("touchstart",(t=>{e=t.touches[0].clientX,i=t.touches[0].clientY})),document.addEventListener("touchmove",(a=>{if(!e||!i)return;const l=e-a.touches[0].clientX,n=i-a.touches[0].clientY;Math.abs(l)<100&&Math.abs(n)<100||(Math.abs(l)>Math.abs(n)?s.direction=l>0?t.LEFT:t.RIGHT:s.direction=n>0?t.UP:t.DOWN,e=null,i=null)}))})(),s.spawn(),n.respawn();const d=setInterval((()=>{s.saveState(),s.tail.unshift({x:s.x,y:s.y}),(s.move()||s.isTail(s.x,s.y))&&(clearInterval(d),s.rollbackState()),s.x===n.x&&s.y===n.y&&(s.tailLength++,n.respawn()),s.tail=s.tail.slice(0,s.tailLength),r.innerText=s.tailLength.toString(),requestAnimationFrame((()=>h(c,o.width,o.height)))}),250);h(c,o.width,o.height)})();