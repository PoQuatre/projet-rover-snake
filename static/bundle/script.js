(()=>{"use strict";var t;!function(t){t[t.UP=0]="UP",t[t.DOWN=1]="DOWN",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT"}(t||(t={}));const e=20,i=50,a=50,l=(t,e,i)=>Math.min(Math.max(t,e),i),n={direction:t.UP,x:0,y:0,tailLength:0,tail:[],move(){let{x:e,y:i}=n;switch(this.direction){case t.UP:i--;break;case t.DOWN:i++;break;case t.LEFT:e--;break;case t.RIGHT:e++}return n.x=l(e,0,9),n.y=l(i,0,9),n.x!==e||n.y!==i},spawn(){this.x=Math.floor(10*Math.random()),this.y=Math.floor(10*Math.random());const e=10-this.x-1,i=10-this.y-1;Math.max(this.x,e)>Math.max(this.y,i)?this.direction=this.x>e?t.LEFT:t.RIGHT:this.direction=this.y>i?t.UP:t.DOWN},isTail(t,e){return this.tail.filter((i=>i.x===t&&i.y===e)).length>0},saveState(){this.state={direction:this.direction,x:this.x,y:this.y,tailLength:this.tailLength,tail:[...this.tail]}},rollbackState(){this.state&&(this.direction=this.state.direction,this.x=this.state.x,this.y=this.state.y,this.tailLength=this.state.tailLength,this.tail=[...this.state.tail])}},s={respawn(){let t=Math.floor(10*Math.random()),e=Math.floor(10*Math.random());for(;t===n.x&&e===n.y||n.isTail(t,e);)t=Math.floor(10*Math.random()),e=Math.floor(10*Math.random());this.x=t,this.y=e}},r=e=>e===t.UP||e===t.DOWN,h=e=>e===t.LEFT||e===t.RIGHT,o=(t,e)=>r(t)&&r(e)||h(t)&&h(e),c=(t,l,r)=>{t.clearRect(0,0,l,r),(t=>{for(let l=0;l<10;l++)for(let n=0;n<10;n++)t.strokeRect(e+l*i,e+n*a,i,a)})(t),(t=>{t.fillStyle="#0f0",t.fillRect(e+n.x*i,e+n.y*a,i,a),t.fillStyle="#000"})(t),(t=>{t.fillStyle="#0f09";for(let l=0;l<n.tail.length;l++)t.fillRect(e+n.tail[l].x*i,e+n.tail[l].y*a,i,a);t.fillStyle="#000"})(t),(t=>{t.fillStyle="#f00","number"==typeof s.x&&"number"==typeof s.y&&t.fillRect(e+s.x*i,e+s.y*a,i,a),t.fillStyle="#000"})(t)},d=document.getElementById("score"),y=document.getElementById("game"),f=y.getContext("2d");if(null===f)throw new Error("An error occured while getting the canvas context");y.width=540,y.height=540,document.addEventListener("keydown",(t=>{"KeyR"===t.code&&window.location.reload()})),document.addEventListener("keydown",(e=>{let i;switch(e.code){case"ArrowUp":case"KeyW":default:i=t.UP;break;case"ArrowDown":case"KeyS":i=t.DOWN;break;case"ArrowLeft":case"KeyA":i=t.LEFT;break;case"ArrowRight":case"KeyD":i=t.RIGHT}o(n.direction,i)||(n.direction=i)})),(()=>{let e=null,i=null;document.addEventListener("touchstart",(t=>{e=t.touches[0].clientX,i=t.touches[0].clientY})),document.addEventListener("touchmove",(a=>{if(!e||!i)return;const l=e-a.touches[0].clientX,s=i-a.touches[0].clientY;if(Math.abs(l)<100&&Math.abs(s)<100)return;let r;r=Math.abs(l)>Math.abs(s)?l>0?t.LEFT:t.RIGHT:s>0?t.UP:t.DOWN,o(n.direction,r)||(n.direction=r),e=null,i=null}))})(),n.spawn(),s.respawn();const x=setInterval((()=>{n.saveState(),n.tail.unshift({x:n.x,y:n.y}),(n.move()||n.isTail(n.x,n.y))&&(clearInterval(x),n.rollbackState()),n.x===s.x&&n.y===s.y&&(n.tailLength++,s.respawn()),n.tail=n.tail.slice(0,n.tailLength),d.innerText=n.tailLength.toString(),requestAnimationFrame((()=>c(f,y.width,y.height)))}),250);c(f,y.width,y.height)})();